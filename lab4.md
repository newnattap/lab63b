# การทดลองที่ 4 การเขียนโปรแกรมอินพุทสัญญาณดิจิทัล

## วัตถุประสงค์
1. เพื่อศึกษาการเขียนโปรแกรมลงบนไมโครตอนโทรลเลอร์
2. เพื่อทดลองนำไมโครคอนโทรลเลอร์ไปประยุกต์ใช้กับอุปกรณ์รับสัญญญาณ

## อุปกรณ์ที่ใช้
1. ไมโครคอนโทรเลอร์(ESP-01)
2. Adapter (พอร์ท 0 สีขาว , พอร์ท 2 สีเหลือง)
3. สาย USB
4. USB to serial
5. หลอดไฟ LED
6. เซนเซอร์รับแสง
7. คอมพิวเตอร์

## ศึกษาข้อมูลเบื้องต้น
[04 run example 4](https://youtu.be/nFqoZT26U5k)

## วิธีการทดลอง
1. เชื่อมต่อ Adapter และ USB to serial เข้าด้วยกัน
2. ต่อไมโครคอนโทรลเลอร์หเข้ากับซีเรียลพอร์ท
3. เปิด command prompt ไปที่ไดรฟ์ D โดยใช้คำสั่ง **D:**
4. เข้าโปรแกรมตัวอย่างโดยใช้คำสั่ง **cd pattani**
5. เลือกโปรแกรมคำสั่ง **cd 04_Input-Port**
6. พิมพ์คำสั่ง vi src/main.cpp เพื่อดูโค้ดโปรแกรม
 ```c
#include <Arduino.h>
#include <ESP8266WiFi.h>

int cnt = 0;

void setup()
{
 Serial.begin(115200);
 pinMode(0, INPUT);
 pinMode(2, OUTPUT);
 Serial.println("\n\n\n");
}

void loop()
{
 int val = digitalRead(0);
 Serial.printf("======= read %d\n", val);
 if(val==1) {
  digitalWrite(2, LOW);
 } else {
  digitalWrite(2, HIGH);
 }
 delay(100);
}
 ```
7. ใช้คำสั่ง pio run -t upload เพื่ออัพโหลดโปรแกรมลงในไมโครคอนโทรนเลอร์
8. กดปุ่มสีดำบนไมโครคอนโทรเลอร์เพื่อให้ดาวโหลด และกดปุ่มรีเซ็ตสีแดงเพื่อรีเซ็ตคำสั่ง

<img width="743" alt="image" src="https://user-images.githubusercontent.com/80879585/112088009-9afaaa80-8bc1-11eb-9152-7941b91df4c3.png">

9. ใช้คำสั่ง**pio device monitor** เพื่อดูผลลัพธ์

<img width="743" alt="image" src="https://user-images.githubusercontent.com/80879585/112088179-ee6cf880-8bc1-11eb-88a0-16f32310d534.png">

10. เสียบสายสีขาวไปที่สายสีดำ เพื่อให้สัญญาณอินพุทเป็น 0 เอาท์พุทจึงอ่านค่าเป็น 0 หลอด LED สว่าง

<img width="743" alt="image" src="https://user-images.githubusercontent.com/80879585/112088969-54a64b00-8bc3-11eb-9591-9d33a6351b80.png">

11. ปุ่มสีดำบนไมโครคอนโทรลเลอร์ก็เชื่อมต่อกับพอร์ท 0 เช่นกัน ดังนั้นเมืกดปุ่มไฟจึงสว่าง

<img width="743" alt="image" src="https://user-images.githubusercontent.com/80879585/112089281-e910ad80-8bc3-11eb-8ec2-7c3bc6589855.png">

12. ต่อเซนเซอร์รับแสงกับสายสีแดงกับตัวต้านทานให้เข้าไปทางพอร์ท 0 

<img width="244" alt="image" src="https://user-images.githubusercontent.com/80879585/112089656-aac7be00-8bc4-11eb-95e7-499d201dc3a0.png">

13. นำสายสีขาว(อินพุท) ต่อเข้ากับเซนเซอร์รับแสง

<img width="237" alt="image" src="https://user-images.githubusercontent.com/80879585/112089933-26296f80-8bc5-11eb-8ea8-d070a02fa607.png">

14. สังเกตที่ตัวเซนเซอร์ หากเอานิ้วปิดที่เซนเซอร์หลอดไฟจะดับ หน้าจออ่านค่าเป็น 1 แต่ถ้าหากไม่ปิดที่เซนเซอร์ หลอดไฟจะสว่าง หน้าจออ่านค่าได้เป็น 0

<img width="730" alt="image" src="https://user-images.githubusercontent.com/80879585/112090126-8ddfba80-8bc5-11eb-9f91-39daf13b8eb5.png">

## การบันทึกผลการทดลอง
1. เมื่อทำการรันคำสั่ง หน้าจอจะอ่านค่าเป็น 1 low ไปที่พอร์ท 2 หลอดไฟจะไม่สว่าง แต่เมื่อต่ออินพุทเข้ากับสายสีดำ hight ไปที่พอร์ท 0 หลอดไฟจะสว่าง นอกจากนี้ปุ่มสีดำบนตัวไมโครคอนโทรลเลอร์ยังเชื่อมต่อกับพอร์ท 0 ดังนั้นเมื่อกดปุ่มหลอดไฟจึงสว่าง
2. เมื่อนำไมโครคอนโทรลเลอร์ไปต่อกับตัวเซนเซอร์รับแสง เมื่อปล่อยให้เซนเซอร์รับแสงหลอดไฟจะสว่าง แต่ถ้าหากทำการบังแสงหลอดไฟจะดับ

## อภิปรายผลการทดลอง
1. จากการทดลองข้างต้น เมื่อเชื่อมสัญญาณอินพุทเข้ากับพอร์ท 0 จะเป็นตัวกำหนดผลลัพธ์ของการสว่างหรือดับของหลอดไฟ ถ้าหากเป็น 1 หลอดไฟดับ เป็น 0 หลอดไฟสว่าง
2. เมื่อนำมาใช้กับเซนเซอร์รับแสง หากทำการบังแสงแรงต้านทานสูง ส่งผลให้อินพุทเป็น 1 หลอดไฟดับ แต่ถ้าไม่ทำการบังแสงแรงต้านทานจะน้อย ส่งผลให้อินพุทเป็น 0 หลอดไฟสว่าง

## คำถามหลังการทดลอง
ถาม เซนเซอ์รับแสงมีประโยชน์อย่างไร ยกตัวอย่าง
ตอบ เซนเซอร์รับแสงสามารถช่วยทำให้ชีวิตประจำวันของเรามีความสะดวกสบายมากขึ้น เช่น การใช้เซนเซอร์รับแสงกับหลอดไฟบริเวณรั้วบ้าน เพื่อให้ไฟเปิดหรือปิดเองอัตโนมัติ
